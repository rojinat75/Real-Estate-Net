{% extends 'base.html' %}
{% load static %}

{% block title %}Premium Checkout - Gorkha Real Estate{% endblock %}

{% block extra_css %}
<style>
.checkout-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
}

.checkout-header {
    text-align: center;
    margin-bottom: 40px;
}

.checkout-header h1 {
    color: var(--nepal-blue);
    font-size: 2.5em;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

.checkout-header p {
    color: #666;
    font-size: 1.2em;
}

.checkout-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    overflow: hidden;
}

.property-info {
    background: linear-gradient(135deg, var(--nepal-blue), var(--nepal-crimson));
    color: white;
    padding: 30px;
    text-align: center;
}

.property-info h2 {
    margin: 0 0 10px 0;
    font-size: 1.8em;
}

.property-info p {
    margin: 0;
    opacity: 0.9;
}

.order-summary {
    padding: 30px;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    padding: 15px 0;
    border-bottom: 1px solid #f0f0f0;
}

.summary-item:last-child {
    border-bottom: none;
    font-size: 1.3em;
    font-weight: 700;
    color: var(--nepal-blue);
}

.plan-details {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 30px;
}

.plan-details h3 {
    color: var(--nepal-blue);
    margin-bottom: 15px;
}

.plan-features {
    list-style: none;
    padding: 0;
}

.plan-features li {
    padding: 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.plan-features li i {
    color: var(--nepal-blue);
    font-size: 1.2em;
}

.payment-section {
    background: #f8f9fa;
    padding: 30px;
    border-radius: 10px;
    margin-top: 20px;
}

.payment-section h3 {
    color: var(--nepal-blue);
    margin-bottom: 20px;
}

.payment-methods {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
}

.payment-method {
    background: white;
    padding: 15px;
    border: 2px solid #ddd;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
}

.payment-method:hover {
    border-color: var(--nepal-blue);
    background: #f0f7ff;
}

.payment-method.selected {
    border-color: var(--nepal-blue);
    background: var(--nepal-blue);
    color: white;
}

.payment-method i {
    font-size: 2em;
    margin-bottom: 10px;
    display: block;
}

.terms {
    font-size: 0.9em;
    color: #666;
    margin-top: 20px;
    line-height: 1.5;
}

.terms a {
    color: var(--nepal-blue);
    text-decoration: none;
}

.terms a:hover {
    text-decoration: underline;
}

.checkout-btn {
    background: linear-gradient(135deg, var(--nepal-blue), var(--nepal-crimson));
    color: white;
    border: none;
    padding: 18px 40px;
    border-radius: 25px;
    font-size: 1.2em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    margin-top: 20px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.checkout-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0,51,160,0.3);
}

.security-badges {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    flex-wrap: wrap;
}

.security-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #28a745;
    font-size: 0.9em;
}

.security-badge i {
    font-size: 1.2em;
}

@media (max-width: 768px) {
    .payment-methods {
        grid-template-columns: 1fr;
    }

    .checkout-header h1 {
        font-size: 2em;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="checkout-container">
    <div class="checkout-header">
        <h1>ðŸ’³ Premium Checkout</h1>
        <p>Complete your premium upgrade and boost your property visibility</p>
    </div>

    <div class="checkout-card">
        <!-- Property Information -->
        <div class="property-info">
            <h2>{{ property.title }}</h2>
            <p>{{ property.city }}, {{ property.state }} â€¢ NPR {{ property.price|intcomma }}</p>
        </div>

        <!-- Order Summary -->
        <div class="order-summary">
            <h3>Order Summary</h3>

            <div class="summary-item">
                <span>Plan Type:</span>
                <span>{{ plan_type|title }}</span>
            </div>
            <div class="summary-item">
                <span>Duration:</span>
                <span>{{ duration_days }} days</span>
            </div>
            <div class="summary-item">
                <span>Subtotal:</span>
                <span>NPR {{ price|intcomma }}</span>
            </div>
            <div class="summary-item">
                <span>Tax:</span>
                <span>NPR 0</span>
            </div>
            <div class="summary-item">
                <span><strong>Total:</strong></span>
                <span><strong>NPR {{ price|intcomma }}</strong></span>
            </div>
        </div>

        <!-- Plan Details -->
        <div class="plan-details">
            <h3>What's Included</h3>
            <ul class="plan-features">
                <li><i class="fas fa-check"></i> Featured placement in search results</li>
                <li><i class="fas fa-check"></i> Priority customer support</li>
                <li><i class="fas fa-check"></i> Detailed analytics dashboard</li>
                <li><i class="fas fa-check"></i> Social media promotion</li>
                <li><i class="fas fa-check"></i> Premium badge on listing</li>
            </ul>
        </div>

        <!-- Payment Section -->
        <div class="payment-section">
            <h3>Payment Method</h3>

            <form method="post">
                {% csrf_token %}

                <div class="payment-methods">
                    <div class="payment-method" onclick="selectPayment(this, 'esewa')">
                        <i class="fas fa-mobile-alt"></i>
                        <div>eSewa</div>
                        <small>Nepal's #1 digital wallet</small>
                    </div>
                    <div class="payment-method" onclick="selectPayment(this, 'khalti')">
                        <i class="fas fa-wallet"></i>
                        <div>Khalti</div>
                        <small>Digital wallet & payments</small>
                    </div>
                    <div class="payment-method" onclick="selectPayment(this, 'credit_card')">
                        <i class="fas fa-credit-card"></i>
                        <div>Credit/Debit Card</div>
                        <small>Visa, MasterCard, etc.</small>
                    </div>
                    <div class="payment-method" onclick="selectPayment(this, 'bank_transfer')">
                        <i class="fas fa-university"></i>
                        <div>Bank Transfer</div>
                        <small>Direct bank transfer</small>
                    </div>
                    <div class="payment-method" onclick="selectPayment(this, 'mobile_banking')">
                        <i class="fas fa-mobile"></i>
                        <div>Mobile Banking</div>
                        <small>Bank mobile apps</small>
                    </div>
                    <div class="payment-method" onclick="selectPayment(this, 'cash')">
                        <i class="fas fa-money-bill-wave"></i>
                        <div>Cash Payment</div>
                        <small>Pay at office</small>
                    </div>
                </div>

                <div class="payment-info">
                    <p><a href="{% url 'premium:payment_methods' %}" target="_blank">View all payment methods & details â†’</a></p>
                </div>

                <input type="hidden" name="payment_method" id="payment_method" required>

                <div class="terms">
                    <p>By completing this purchase, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.</p>
                    <p>Your subscription will auto-renew unless cancelled. You can cancel anytime from your dashboard.</p>
                </div>

                <button type="submit" class="checkout-btn">
                    <i class="fas fa-credit-card"></i> Process Payment - NPR {{ price|intcomma }}
                </button>
            </form>

            <!-- Security Badges -->
            <div class="security-badges">
                <div class="security-badge">
                    <i class="fas fa-shield-alt"></i>
                    <span>Secure Payment</span>
                </div>
                <div class="security-badge">
                    <i class="fas fa-lock"></i>
                    <span>SSL Encrypted</span>
                </div>
                <div class="security-badge">
                    <i class="fas fa-undo-alt"></i>
                    <span>Money Back Guarantee</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function selectPayment(element, method) {
    // Remove selected class from all payment methods
    document.querySelectorAll('.payment-method').forEach(pm => {
        pm.classList.remove('selected');
    });

    // Add selected class to clicked method
    element.classList.add('selected');

    // Set the hidden input value
    document.getElementById('payment_method').value = method;
}

// Form validation
document.querySelector('.checkout-btn').addEventListener('click', function(e) {
    const paymentMethod = document.getElementById('payment_method').value;
    if (!paymentMethod) {
        e.preventDefault();
        alert('Please select a payment method.');
        return false;
    }

    // Show loading state
    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing Payment...';
    this.disabled = true;
});
</script>
{% endblock %}
