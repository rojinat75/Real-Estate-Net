{% extends 'base.html' %}
{% load static %}
{% load socialaccount %}

{% block title %}Join Real Estate Nepal - Create Your Account{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/register.css' %}">
{% endblock %}

{% block content %}
<div class="register-container">
    <div class="register-header">
        <h1>üöÄ Join Real Estate Nepal</h1>
        <p>Create your account and start your real estate journey</p>
    </div>

    <!-- Social Signup Buttons - Horizontal Icons -->
    <div class="social-login-horizontal" style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <p class="social-login-text">Sign up quickly with</p>
        <div class="social-icons-horizontal">
            <a href="{% provider_login_url 'google' %}" class="social-icon-link" title="Sign up with Google" aria-label="Sign up with Google">
                <div class="social-icon google-icon">
                    <img src="{% static 'images/google.png' %}" alt="Google" style="width: 24px; height: 24px;">
                </div>
            </a>
            <a href="{% provider_login_url 'facebook' %}" class="social-icon-link" title="Sign up with Facebook" aria-label="Sign up with Facebook">
                <div class="social-icon facebook-icon">
                    <img src="{% static 'images/facebook.png' %}" alt="Facebook" style="width: 24px; height: 24px;">
                </div>
            </a>
            <a href="{% provider_login_url 'linkedin_oauth2' %}" class="social-icon-link" title="Sign up with LinkedIn" aria-label="Sign up with LinkedIn">
                <div class="social-icon linkedin-icon">
                    <img src="{% static 'images/linkedin.png' %}" alt="LinkedIn" style="width: 24px; height: 24px;">
                </div>
            </a>
            <a href="{% provider_login_url 'twitter' %}" class="social-icon-link" title="Sign up with Twitter" aria-label="Sign up with Twitter">
                <div class="social-icon twitter-icon">
                    <img src="{% static 'images/twitter.png' %}" alt="Twitter" style="width: 24px; height: 24px;">
                </div>
            </a>
        </div>
        <!-- Social Login Warning -->
        <div style="text-align: center; margin-top: 15px; color: #856404; font-size: 1.em; font-weight: bold; background: #fff3cd; padding: 8px; border-radius: 5px; border: 1px solid #ffeaa7;">
            <span style="font-size: 1.2em;">‚ö†Ô∏è</span>
            <span style="margin-left: 5px;">Social login is not currently functional</span>
        </div>
    </div>

    <div class="social-divider">
        <span>Or sign up with email</span>
    </div>

    <form method="post" id="registrationForm">
        {% csrf_token %}

        <!-- Registration Form -->
        <div class="registration-form-container">
            <h2>üìù Account Information</h2>

        <div class="form-grid">
            <div class="form-group">
                <label for="{{ form.username.id_for_label }}">Username</label>
                {{ form.username }}
                {% if form.username.errors %}
                    {% for error in form.username.errors %}
                        <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.phone_number.id_for_label }}">Phone Number <span style="color: #666; font-weight: normal; font-size: 0.8em;">(optional)</span></label>
                {{ form.phone_number }}
                {% if form.phone_number.errors %}
                    {% for error in form.phone_number.errors %}
                        <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.address.id_for_label }}">Address <span style="color: #666; font-weight: normal; font-size: 0.8em;">(optional)</span></label>
                {{ form.address }}
                {% if form.address.errors %}
                    {% for error in form.address.errors %}
                        <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        <div class="form-group" style="margin-bottom: 25px;">
            <label for="{{ form.user_type.id_for_label }}">{{ form.user_type.label }}</label>
            {{ form.user_type }}
            {% if form.user_type.errors %}
                {% for error in form.user_type.errors %}
                    <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                {% endfor %}
            {% endif %}
            <p style="font-size: 0.8em; color: #666; margin-top: 5px;">{{ form.user_type.help_text }}</p>
        </div>

        <div class="form-grid">
        </div>

        <div class="form-grid">
            <div class="form-group">
                <label for="{{ form.password1.id_for_label }}">Password</label>
                <div class="password-group">
                    {{ form.password1 }}
                    <button type="button" class="password-toggle" data-target="{{ form.password1.id_for_label }}" title="Show/Hide password">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                {% if form.password1.errors %}
                    {% for error in form.password1.errors %}
                        <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.password2.id_for_label }}">Confirm Password</label>
                <div class="password-group">
                    {{ form.password2 }}
                    <button type="button" class="password-toggle" data-target="{{ form.password2.id_for_label }}" title="Show/Hide password">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                {% if form.password2.errors %}
                    {% for error in form.password2.errors %}
                        <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        <!-- Terms Agreement Section -->
        <div class="terms-agreement-section">
            <div class="terms-checkbox-group">
                <div class="checkbox-input">
                    {{ form.agree_terms }}
                </div>
                <div class="checkbox-label">
                    {{ form.agree_terms.label }}
                </div>
            </div>
            {% if form.agree_terms.errors %}
                {% for error in form.agree_terms.errors %}
                    <div style="color: var(--nepal-crimson); font-size: 0.9em; margin-top: 5px;">{{ error }}</div>
                {% endfor %}
            {% endif %}
        </div>

        <div class="form-actions">
            <button type="submit" form="registrationForm" class="submit-btn" id="submitBtn">
                üöÄ Create Account
            </button>
        </div>
    </div>

    <div class="login-link">
        <p>Already have an account?</p>
        <a href="{% url 'accounts:login' %}">Login here</a>
    </div>
</div>

<script>
// Password toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    const toggles = document.querySelectorAll('.password-toggle');

    toggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetInput = document.getElementById(targetId);
            const icon = this.querySelector('i');

            if (targetInput.type === 'password') {
                targetInput.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                targetInput.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    });
});
</script>

<script>
// No need for custom JavaScript since we're using a standard select dropdown now
</script>
{% endblock %}
